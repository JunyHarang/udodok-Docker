{"version":3,"sources":["webpack://sleact-js-front/./apis/accessTokenUpdate.js","webpack://sleact-js-front/./apis/apiController.js","webpack://sleact-js-front/./pages/MyBookRecord/index.jsx"],"names":["refresh_token","JSON","parse","localStorage","getItem","instance","axios","baseURL","timeout","interceptors","request","use","config","headers","err","console","dir","Promise","reject","response","res","data","access_token","withCredentials","originalRequest","errorState","message","accessTokenUpdate","url","method","setItem","stringify","accessToken","Authorization","MyBookRecord","props","state","useSelector","auth","userId","user","user_id","currentPage","setCurrentPage","useState","totalElements","setTotalElements","sharedBoards","setSharedBoards","useEffect","handlePageChange","page","params","apiController","content","pagination","total_elements","current_page","onClickEdit","useCallback","history","push","height","map","board","index","title","create_at","book_report_id","book_name","book_report_tag","marginBottom","marginLeft","withRouter"],"mappings":"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","file":"pages_MyBookRecord_index_jsx.js","sourcesContent":["import axios from 'axios';\n\nconst refresh_token = JSON.parse(localStorage.getItem('refresh_token'));\n\nconst instance = axios.create({\n  baseURL: '/api',\n  timeout: 1000,\n});\n\ninstance.interceptors.request.use(\n  (config) => {\n    config.headers['Content-Type'] = 'application/json; charset=utf-8';\n    config.headers['Authorization'] = 'Bearer ' + refresh_token;\n    return config;\n  },\n  (err) => {\n    console.dir(err);\n    return Promise.reject(err);\n  },\n);\n\ninstance.interceptors.response.use(\n  (res) => {\n    return res.data;\n  },\n  (err) => {\n    console.dir(err);\n    return Promise.reject(err);\n  },\n);\n\nexport default instance;\n","import axios from 'axios';\nimport accessTokenUpdate from '@apis/accessTokenUpdate';\n\nconst access_token = JSON.parse(localStorage.getItem('access_token'));\n\nconst instance = axios.create({\n  baseURL: '/api',\n  withCredentials: true,\n  timeout: 1000,\n});\n\ninstance.interceptors.request.use(\n  (config) => {\n    config.headers['Content-Type'] = 'application/json; charset=utf-8';\n    config.headers['Authorization'] = 'Bearer ' + access_token;\n    return config;\n  },\n  (err) => {\n    console.dir(err);\n    return Promise.reject(err);\n  },\n);\n\ninstance.interceptors.response.use(\n  (res) => {\n    return res;\n  },\n  async (err) => {\n    // errorController(err);\n    const originalRequest = err.config;\n    const errorState = err.response.data.message;\n\n    if (errorState === '엑세스토큰 불일치') {\n      const { data } = await accessTokenUpdate({\n        url: '/token',\n        method: 'get',\n      });\n\n      localStorage.setItem('access_token', JSON.stringify(data.access_token));\n      const accessToken = data.access_token;\n\n      originalRequest.headers.Authorization = 'Bearer ' + accessToken;\n      return axios(originalRequest);\n    }\n    return Promise.reject(err);\n  },\n);\n\nexport default instance;\n","import React, { useEffect, useState, useCallback } from 'react';\nimport Header from '@layouts/Header';\nimport Footer from '@layouts/Footer';\nimport { Container, Title, Content, PopularCards, SharedCards, Button } from '@pages/ShareBoard/styles';\nimport Cards from '@components/Cards';\nimport { Row } from 'antd';\nimport Paging from '@components/Paging';\nimport { withRouter } from 'react-router';\nimport { useSelector } from 'react-redux';\nimport apiController from '@apis/apiController';\n\nconst MyBookRecord = (props) => {\n  const state = useSelector((state) => state.auth);\n  const userId = state.user.user_id;\n\n  const [currentPage, setCurrentPage] = useState(0);\n  const [totalElements, setTotalElements] = useState(0);\n  const [sharedBoards, setSharedBoards] = useState([]);\n\n  useEffect(() => {\n    handlePageChange(currentPage);\n  }, []);\n\n  const handlePageChange = async (page) => {\n    let params = {\n      page: page - 1,\n    };\n    const res = await apiController({\n      url: `/bkusers/book-reports/${userId}`,\n      method: 'get',\n      data: params,\n    });\n\n    if (res.data.message === '조회성공') {\n      setSharedBoards(res.data.data.content);\n      setTotalElements(res.data.pagination.total_elements);\n      setCurrentPage(res.data.pagination.current_page);\n    }\n  };\n\n  const onClickEdit = useCallback(() => {\n    props.history.push('/mybookrecord/write');\n  }, []);\n\n  // if (!sharedBoards || !totalElements) {\n  //   return <div>Loading...</div>;\n  // }\n\n  return (\n    <div style={{ height: '100%' }}>\n      <Container>\n        <Header />\n        <Title>기록 게시판</Title>\n        <Content>\n          <h4>나의 게시물</h4>\n          <SharedCards>\n            <Row gutter={[16, 32]}>\n              {sharedBoards &&\n                sharedBoards.map((board, index) => (\n                  <React.Fragment key={index}>\n                    <Cards\n                      title={board.title}\n                      createdBoard={board.create_at}\n                      boardId={board.book_report_id}\n                      bookTitle={board.book_name}\n                      bookTag={board.book_report_tag}\n                    />\n                  </React.Fragment>\n                ))}\n            </Row>\n          </SharedCards>\n        </Content>\n        <div style={{ marginBottom: '50px' }}>\n          <Button onClick={onClickEdit}>작성하기</Button>\n        </div>\n        <div style={{ marginLeft: '150px' }}>\n          <Paging\n            bookBoard={true}\n            totalElements={totalElements}\n            currentPage={currentPage}\n            handlePageChange={handlePageChange}\n          />\n        </div>\n      </Container>\n      <Footer />\n    </div>\n  );\n};\n\nexport default withRouter(MyBookRecord);\n"],"sourceRoot":""}